{"version":3,"sources":["./src/app/userreg/userreg.page.scss","./src/app/userreg/userreg.module.ts","./src/app/userreg/userreg.page.ts","./src/app/userreg/userreg-routing.module.ts","./src/app/userreg/userreg.page.html","./src/app/verification.ts"],"names":[],"mappings":"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","file":"userreg-userreg-module.js","sourcesContent":["export default \"ion-toolbar {\\n  --color: #ffffff;\\n  --background: #E21F2D;\\n  --ion-border-color: transparent;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXHVzZXJyZWcucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsZ0JBQUE7RUFDQSxxQkFBQTtFQUNBLCtCQUFBO0FBQ0YiLCJmaWxlIjoidXNlcnJlZy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJpb24tdG9vbGJhciB7XHJcbiAgLS1jb2xvcjogI2ZmZmZmZjtcclxuICAtLWJhY2tncm91bmQ6ICNFMjFGMkQ7XHJcbiAgLS1pb24tYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudDtcclxufVxyXG4iXX0= */\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { UserregPageRoutingModule } from './userreg-routing.module';\n\nimport { UserregPage } from './userreg.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    UserregPageRoutingModule\n  ],\n  declarations: [UserregPage]\n})\nexport class UserregPageModule {}\n","import {Component, OnDestroy, OnInit} from '@angular/core';\nimport {User} from '../user';\nimport {PropsService} from '../props.service';\nimport {Verification} from '../verification';\nimport {NavController, ToastController} from '@ionic/angular';\nimport {takeUntil} from 'rxjs/operators';\n\n@Component({\n  selector: 'app-userreg',\n  templateUrl: './userreg.page.html',\n  styleUrls: ['./userreg.page.scss'],\n})\nexport class UserregPage implements OnInit, OnDestroy {\n\n  constructor(private props: PropsService, public toastController: ToastController, private nav: NavController) { }\n\n  surname = '';\n  name = '';\n  email = '';\n  password = '';\n  verificationCode = '';\n  commitCodeSend = false;\n  verifyCodeHasBeenSend = false;\n  events;\n\n  ngOnDestroy(): void {\n    this.events.unsubscribe();\n  }\n  ngOnInit() {\n    if (this.props.userId !== ''){\n      this.nav.navigateForward('/tabs/tab1');\n    }\n    this.events = this.props.event.subscribe(event => {\n      if (event === 'wrongVerifyCode'){\n        this.commitCodeSend = false;\n        this.toastController.create({\n          message: 'Код введён неверно',\n          duration: 2000\n        }).then(toast => toast.present());\n      }\n      if (event === 'userReceived'){\n        this.commitCodeSend = false;\n        this.toastController.create({\n          message: 'Регистрация прошла успешно.',\n          duration: 2000\n        }).then(toast => toast.present());\n        this.nav.navigateForward('/tabs/tab4');\n      }\n      if (event === 'userAlreadyExists'){\n        this.toastController.create({\n          message: 'Пользоатель с таким e-mail уже зарегистрирован',\n          duration: 2000\n        }).then(toast => toast.present());\n      }\n      if (event === 'verifyCodeHasBeenSend'){\n        this.verifyCodeHasBeenSend = true;\n      }\n    });\n  }\n\n  getCode() {\n    const user = new User();\n    user.name = this.name;\n    user.surname = this.surname;\n    user.email = this.email;\n    user.password = this.password;\n    this.props.getVerifyCode(user);\n  }\n\n  isGetCodeDisabled() {\n    const r = new RegExp('^[^@]+@[^.]+\\\\..*');\n    const errorInput = this.surname.trim() === '' || this.name.trim() === '' || this.password.trim() === '' || !r.test(this.email);\n    return errorInput || this.verifyCodeHasBeenSend;\n  }\n\n  commitCode() {\n    this.commitCodeSend = true;\n    const v = new Verification();\n    v.code = this.verificationCode;\n    v.user = this.email;\n    this.props.checkVerifyCode(v);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { UserregPage } from './userreg.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserregPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class UserregPageRoutingModule {}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button></ion-menu-button>\\n      <ion-back-button text=\\\"Назад\\\" class=\\\"text-white\\\"></ion-back-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content [fullscreen]=\\\"true\\\">\\n  <div class=\\\"\\\">\\n    <div class=\\\"ion-margin\\\">\\n      <div class=\\\"ion-padding-top\\\">\\n        <h1 class=\\\"bold\\\">Новый пользователь</h1>\\n      </div>\\n      <div class=\\\"ion-padding-top\\\">\\n        <div>Заполните данные чтобы зарегистрироваться и получить доступ к покупке и просмотру журналов</div>\\n      </div>\\n      <ion-list lines=\\\"full\\\" class=\\\"ion-padding-top\\\">\\n        <ion-item>\\n          <ion-label position=\\\"fixed\\\">E-mail</ion-label>\\n          <ion-input type=\\\"email\\\" [(ngModel)]=\\\"email\\\" placeholder=\\\"введите ваш e-mail\\\"></ion-input>\\n        </ion-item>\\n        <ion-item>\\n          <ion-label position=\\\"fixed\\\">Фамилия</ion-label>\\n          <ion-input [(ngModel)]=\\\"surname\\\" placeholder=\\\"введите вашу фамилию\\\"></ion-input>\\n        </ion-item>\\n        <ion-item>\\n          <ion-label position=\\\"fixed\\\">Имя</ion-label>\\n          <ion-input [(ngModel)]=\\\"name\\\" placeholder=\\\"введите ваше имя\\\"></ion-input>\\n        </ion-item>\\n        <ion-item>\\n          <ion-label position=\\\"fixed\\\">Пароль</ion-label>\\n          <ion-input type=\\\"password\\\" [(ngModel)]=\\\"password\\\" placeholder=\\\"придумайте пароль\\\"></ion-input>\\n        </ion-item>\\n      </ion-list>\\n      <div class=\\\"cx my-1\\\">\\n        <ion-button [disabled]=\\\"isGetCodeDisabled()\\\" class=\\\"bold eurasian-color\\\" color=\\\"none\\\" size=\\\"medium\\\" (click)=\\\"getCode()\\\">продолжить</ion-button>\\n      </div>\\n      <div class=\\\"ion-padding-top\\\" *ngIf=\\\"verifyCodeHasBeenSend\\\">\\n        <div>Проверьте вашу почту и введите полученный проверочный код в поле ниже</div>\\n        <ion-item class=\\\"ion-padding-top\\\">\\n          <ion-label position=\\\"fixed\\\">Код</ion-label>\\n          <ion-input [(ngModel)]=\\\"verificationCode\\\" placeholder=\\\"код подтверждения\\\"></ion-input>\\n        </ion-item>\\n        <div class=\\\"cx my-1\\\">\\n          <ion-button [disabled]=\\\"verificationCode.trim().length != 4\\\" class=\\\"bold eurasian-color\\\" color=\\\"none\\\" size=\\\"medium\\\" (click)=\\\"commitCode()\\\">подтвердить</ion-button>\\n        </div>\\n        <div class=\\\"cx my-1\\\" *ngIf=\\\"commitCodeSend\\\">\\n          <ion-spinner name=\\\"lines\\\"></ion-spinner>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</ion-content>\\n\";","export class Verification {\n  user = '';\n  code = '';\n}\n"],"sourceRoot":"webpack:///"}